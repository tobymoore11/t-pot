# 1. What is T-PoT? #

T-PoT is a plug-in for Total Commander allowing to browse the Apple iPod Touch and iPhone contents via USB.

# 2. Features #

So far, it allows to
  * transfer files/directories between the iPod and the PC
  * move files/directories between the iPod and the PC
  * remove files/directories from the iPod
  * create directories on the iPod
  * PNG image conversion
  * binary PLIST file conversion

Plus all the associated functionalities in TC (comparing files, searching directories, compressing/decompressing files, ...).

# 3. Missing Features #

**API Limitations**

This plug-in is based on iTunes API which allows to access the iPod file system by the USB, unfortunately this API isn't publicly documented yet. For the moment, some features are either not part of the API or were not discovered so far:
  * getting/setting attributes
    * permission flags
    * date of creation/modification/...
    * most file types: block/character device, soft links, ...
  * partition information: free/occupied space, file system type
  * sending commands that could be hooked on the device
  * setting an access password

The most annoying being the first one: it is possible to transfer files to the iPod, but the file permission flags can't be set via the USB port. As a result, the executables need to be changed on an SSH session or they will not execute properly, using MobileFinder is also a possibility if you don't have a wireless connection.

The data files will always have the same permissions, but this is currently not a concern since everything on an iPod is running with root credentials.

# 4. Installing the Plug-In #

Check the [Installation](Installation.md) page for the illustrated procedure.

Now the plug-in will automatically install itself when you open the downloaded .zip archive. When updating, this will overwrite the previous version.

If you had installed the plug-in manually before (versions < 0.4), all you have to do is to open the .zip file to install the new version. Since the directory might be different than before, you may want to remove the old files in 

&lt;TotalCommander&gt;

\plugins\wfx\t-pot (for some obscure reason, Total Commander doesn't make it possible to use 2 directory levels like _plugins\wfx\<plug-in name>_ with pluginst.inf, and some versions store the plug-in directly under the plugins\ subdirectory).

# 5. History #

**wipod\_3.0**

> I simply updated the HTTP\_USER\_AGENT to mimic the new Installer ("AppTapp Installer/3.0 (iPhone)"), since some repositories refuse the connection for older versions.

**Version 1.1**

  * Now handles files bigger than 4GB (not fully tested).
  * Allows to copy files from the iPod to the iPod, what really happens is that the file is copied to a temporary file on the PC, then back to the iPod. I would rather recommend to use an iPod application to do that (MobileFinder would be a good choice), in order to preserve the permission flags on the files, it's also much faster because it doesn't have to pass through the USB connection. This feature was only added for the sake of completeness since Total Commander allows it.

**wipod**

> Here is a little tool (just a by-product of an experiment) that can be used to download files and web contents, making the server believe the request comes from an iPod Installer program, or from an iPod Safari.

> Some web servers check the HTTP\_USER\_AGENT to detect what is browsing their website: Firefox, the evil IE, an iPod, ... and thus redirect the request to the appropriate content. So if you try to get a repository plist script or even a zip file, in some case you might end up with something entirely different, which is annoying if you want to debug a repository or <insert other motives here>.

> Tip: _transfer a plist file to the iPod, then back to the PC using the T-PoT plug-in, to err... "beautify" the file_. When you copy plist files from the iPod file system, T-PoT actually parses the plist file (either binary or text), and recreates it from the internal representation. As a side-effect, everything is indented correctly again, and keys are sorted alphabetically.

**Version 1.0**

  * Plist translation code has been redone from scratch, based on the Apple CoreFoundation references. It's now simpler - at least as much as the Apple way would allow... - and doesn't leak memory like the previous one which was based on an existing hack.

> Let's just say I wouldn't like to develop applications for MacOS, this CoreFoundation is heavy as hell (and I didn't even had to use Objective-C). Hopefully they'll soon get out of the stone age and use C++.

**Version 0.4**

  * Self-installing plug-in. Easier.

**Version 0.3**

  * New feature:
    * Binary Property Lists Conversion:

> Most of the plist files originally on the iPod - used or generated by the original applications - are stored in binary format on the iPod, which makes them unreadable especially on Windows-based systems since they lack the property list support naturally found on MacOS Systems (e.g. plutil command, ...).

> The plug-in now automatically converts them to text (XML) when they are transferred from the iPod to the PC. This is also done when they are compared, viewed or edited, since this implies a copy to a temporary file on the PC.

**TranslatePNG**

> I added a stand-alone little Windows program to fix the iPod PNG images and convert them to true PNG files you can see with any viewer/graphics editor. It's in the Downloads section.

**Version 0.2**

  * New feature:
    * PNG image conversion:

> Apple uses a non-compliant PNG format to store the images on the iPod. A converter is integrated in the plug-in to generate proper PNG files when they are copied from the iPod to the PC.

> For some reason, the PNG images found in the original applications have a new chunk type "CgBl" which signals different modifications in the IDAT chunks:
    * No header/footer in the zlib-deflated data,
    * Inversion of the red and blue channels.
> Besides, this CgBl chunk is found before the IHDR chunk, which should normally be in the first position.

  * Note:
> This version was compiled with Visual 2005 and Visual 2003, for which the libraries should be more widely installed (they are also provided in the download section).

**Version 0.1**

> This is the first public release, it has been tested for a while so not many bugs should be expected. This version has been compiled with Visual Studio 2005, so it needs the following in order to run:
    * [Microsoft .NET Framework Version 2.0 Redistributable Package (x86)](http://www.microsoft.com/downloads/details.aspx?FamilyID=0856EACB-4362-4B0D-8EDD-AAB15C5E04F5&displaylang=en)
> Which requires the following:
    * [Windows Installer 3.0 Redistributable](http://www.microsoft.com/downloads/details.aspx?familyid=5FBC5470-B259-4733-A914-A956122E08E8&displaylang=en) (needs genuine Windows)
> Yes, this is a bit painful but most of the PC should have evolved to .NET 2.0 already. I'll provide a version for older system next time ;)

# 6. Related Links #

Based on Monzana (which is apparently dead):
  * [iPhoneList project](http://code.google.com/p/iphonelist/) - Explorer-like transfer program.
  * [iPhoneBrowser project](http://code.google.com/p/iphonebrowser/) - Another Explorer-like transfer program, which also converts the images from the iPod.

Based on the [SharePod SDK](http://www.sturm.net.nz/website.php?Section=iPod+Programs&Page=SharePod+SDK):
  * [iPodNet plugin 1.0.0.1](http://tbeu.totalcmd.net/) (doesn't work for me though - maybe it can't be used with jailbroken iPod's).

# 7. Credits #

  * All the people in general who have worked hard to make the jailbreak possible, without them this kind of plug-in wouldn't make much sense.
  * The people involved in the iPHUC and Manzana projects, who explored the iTunesMobileDevice library and extracted most of the API.
  * MHW and Guillaume Cottenceau whose code served as a base to convert the PNG images.

# 8. Trademark and Copyright Statements #

  * Apple, iPod, iPhone, iTunes and Mac OS are trademarks of Apple Computer, Inc., registered in the U.S. and other countries. All rights reserved.
  * Total Commander is Copyright (C) 1993-2007 by Christian Ghisler, C. Ghisler & Co.

All mentioned Trademarks and Copyrights belong to their respective owners.